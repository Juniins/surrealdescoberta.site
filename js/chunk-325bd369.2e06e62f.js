(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-325bd369"],{"3d55":function(t,e,s){"use strict";s("c582")},"409b":function(t,e,s){},"6bb1":function(t,e,s){"use strict";s("409b")},"87ca":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.userLevel?s("div",{staticClass:"container1"},[s("van-nav-bar",{staticClass:"header blueheader",attrs:{fixed:"","z-index":"999"},scopedSlots:t._u(["F_49"===t.systemVersion?{key:"title",fn:function(){return[s("span",{staticClass:"text-000 font-bold"},[t._v("Khu vực phối hợp sản phẩm nhiệm vụ")])]},proxy:!0}:null,{key:"right",fn:function(){return[s("zlink",{attrs:{to:"/m/support"}},[s("i",{staticClass:"material-icons"},[t._v("support_agent")])])]},proxy:!0}],null,!0)}),s("div",{staticClass:"statisticalbg"},[s("div",{staticClass:"row",staticStyle:{margin:"0"}},[s("div",{staticClass:"col"},[s("h3",{staticClass:"mb-0 font-weight-normal"},[t._v(t._s(t.formatMoney(t.userMoney.balance)))]),s("div",{staticClass:"text-mute text-secondary"},[t._v(t._s(t.$t("message.Balance")))])]),s("div",{staticClass:"col-auto"},[s("van-button",{staticClass:"btn btn-rounded-54 shadow",attrs:{round:"",type:"primary",to:"/m/user/recharge"}},[s("i",{staticClass:"material-icons"},[t._v("add")])])],1)]),s("div",[t.levelInfo&&t.userMoney&&t.planGroupInfo?s("div",{staticClass:"z-1"},[s("div",{staticClass:"card bg-template shadow mt-4"},[s("div",{staticClass:"card-body"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-10"},[s("h3",[t._v(t._s(t.levelInfo.name))])])]),s("div",{staticClass:"row"},["L_21"!=t.paramMapAll["SYSTEM_VERSION"]?s("div",{staticClass:"col-12 mt-2"},[s("h5",{staticClass:"font-weight-normal"},[t._v(t._s(t.$t("message.最低余额"))+" "+t._s(t.formatMoney(t.levelInfo.balance)))])]):t._e(),"F_25"!==t.paramMapAll["SYSTEM_VERSION"]?s("div",{staticClass:"col-12"},[s("div",[t._v(t._s(t.$t("message.佣金"))+" "+t._s(t.getCommission))])]):t._e(),"1"!==t.paramMapAll["ORDERS_NUMBER_CLOSE"]?["1"!==t.paramMapAll["ORDERS_NUMBER_OPEN"]?s("div",{staticClass:"col-12 mt-1"},[s("h3",{staticClass:"text-center"},[s("span",{staticClass:"ft-14"},[t._v(t._s(t.$t("message.未完成"))+"：")]),s("span",{staticClass:"text-red"},[t._v(t._s(t.getLeftTimes))])]),s("p")]):s("div",{staticClass:"col-12 mt-1"},[s("h3",{staticClass:"text-center"},[s("span",{staticStyle:{background:"limegreen",padding:"0 5px"}},[t._v(t._s(t.userMoney.todayGrabTimes||0))]),t._v("/"+t._s(t.getFinishTimes))]),s("p")])]:t._e()],2)])])]):t._e(),s("div",{staticClass:"z-0"},[s("div",{staticClass:"card shadow"},[s("div",{staticClass:"card-body border-bottom"},[s("div",{staticClass:"row"},["1"!==t.paramMapAll["GRAB_COMMISSION_CLOSE"]?s("div",{staticClass:"col"},[s("div",[t._v(t._s(t.formatMoney(t.userMoney.totalGrabCommission))),s("br"),s("small",{staticClass:"text-mute text-secondary"},[t._v(t._s(t.$t("message.佣金")))])])]):t._e(),"1"!==t.paramMapAll["PACK_OPEN"]?s("div",{staticClass:"col text-right"},[s("div",[t._v(t._s(t.formatMoney(t.userMoney.frozenMoney+t.userMoney.frozenBalance||0))),s("br"),s("small",{staticClass:"text-mute text-secondary"},[t._v(t._s(t.$t("message.冻结金额")))])])]):t._e()])]),s("div",{staticClass:"card-body border-bottom"},[s("div",{staticClass:"row"},["1"===t.paramMapAll["UNFINISHED_ORDERS_OPEN"]?s("div",{staticClass:"col-12 mt-1"},[s("h3",{staticClass:"text-center"},[s("span",{staticClass:"ft-14"},[t._v(t._s(t.$t("message.未完成"))+"：")]),s("span",{staticClass:"text-red"},[t._v(t._s(t.getLeftTimes))])]),s("p")]):t._e(),s("div",{staticClass:"col text-right"},[s("div",[t._v("\n                    "+t._s(t.formatMoney(t.userMoney.tyMoney))),s("br"),s("small",{staticClass:"text-mute text-secondary"},[t._v(t._s(t.$t("message.任务经费")))]),s("br"),"1"!==t.paramMapAll["RECHARGE_VIP_TO_TY_MONEY"]?s("small",{staticClass:"text-mute text-secondary"},[t._v(t._s(t.userMoney.tyDueTime))]):t._e()])])])]),s("div",{staticClass:"card-footer bg-none pa-1"},[s("van-button",{staticClass:"btn btn-block btn-lg btn-rounded shadow",attrs:{type:"primary",loading:t.loading},on:{click:t.grab}},[s("i",{staticClass:"material-icons text-mute"},[t._v("swipe")]),s("span",{staticClass:"ml-2"},[t._v(t._s(t.$t("message.抢单")))])])],1)])])]),s("van-notice-bar",{attrs:{color:"#999",background:"#ffffff","left-icon":"volume-o",scrollable:!1}},[s("van-swipe",{staticClass:"notice-swipe",attrs:{vertical:"",autoplay:1e3,"show-indicators":!1}},t._l(t.commission_list,(function(e,a){return s("van-swipe-item",{key:a},[s("span",[t._v(t._s(e.phone))]),s("span",[t._v(t._s(t.$t("message.收入佣金"))+" "+t._s(t.formatMoney(e.money)))]),s("span",[t._v(t._s(e.date))])])})),1)],1),s("div",{staticClass:"tips pt-5 textarea-content",domProps:{innerHTML:t._s(t.paramMapAll["GRAB_TIPS"])}}),"1"===t.paramMapAll["RECHARGE_AUTH_PIC_OPEN"]?s("div",{staticClass:"mt-2 mb-2"},[s("van-grid",{staticClass:"partner",attrs:{clickable:"",border:!1,"column-num":3}},t._l(6,(function(t,e){return s("van-grid-item",{key:e,attrs:{text:""}},[s("img",{attrs:{src:"/static/mobile/recharge/auth_"+t+".png",width:"100%"}})])})),1)],1):t._e()],1),t.orders?[s("van-popup",{staticClass:"pop-pic",attrs:{closeable:""},on:{closed:function(e){t.showDetail=!0}},model:{value:t.showPopPic,callback:function(e){t.showPopPic=e},expression:"showPopPic"}},[s("img",{staticStyle:{"max-width":"100%"},attrs:{src:t.getFileViewUrl(t.orders.popPic)}})]),s("orders-detail",{attrs:{orders:t.orders,show:t.showDetail},on:{close:t.closeOrders,confirm:t.confirm}})]:t._e()],2):t._e()},i=[],n=s("a34a"),o=s.n(n),r=s("c18d"),c=s("c24f"),l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("van-popup",{staticClass:"pop-pic",attrs:{closeable:""},model:{value:t.showPopPic,callback:function(e){t.showPopPic=e},expression:"showPopPic"}},[s("img",{staticStyle:{"max-width":"100%"},attrs:{src:t.getFileViewUrl(t.orders.popPic)}})]),!t.showPopPic&&t.show?s("van-dialog",{attrs:{title:t.$t("message.订单详情"),"cancel-button-text":"F_25"===t.paramMapAll["SYSTEM_VERSION"]?t.$t("message.恭喜你"):t.$t("message.关闭"),"confirm-button-text":"F_25"===t.paramMapAll["SYSTEM_VERSION"]?t.$t("message.抢单成功"):t.$t("message.确定"),"close-on-click-overlay":"",width:"90%"},on:{confirm:t.commit},model:{value:t.showNew,callback:function(e){t.showNew=e},expression:"showNew"}},[t.orders?s("div",{staticClass:"card pa-2"},[s("van-icon",{staticClass:"ic-close",attrs:{name:"close"},on:{click:function(e){return t.close()}}}),s("div",{staticClass:"row justify-center"},[s("img",{attrs:{alt:"",id:"oimg",src:t.getFileViewUrl(t.orders.goodsPic)}})]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.订单号")))]),s("div",{staticClass:"col-auto text-right text-mute"},[t._v(t._s(t.orders.no))])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.下单时间")))]),s("div",{staticClass:"col-auto text-right text-mute"},[t._v(t._s(t.orders.createTime))])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.商品单价")))]),s("div",{staticClass:"col-auto text-right text-mute",attrs:{id:"goods_price"}},[t._v(t._s(t.formatMoney(t.orders.price)))])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.商品数量")))]),s("div",{staticClass:"col-auto text-right text-mute"},[t._v("x "),s("span",{attrs:{id:"goods_num"}},[t._v(t._s(t.orders.number))])])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.订单总额")))]),s("div",{staticClass:"col-auto text-right text-mute",attrs:{id:"ototal"}},[t._v(t._s(t.formatMoney(t.orders.totalPrice)))])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.佣金")))]),s("div",{staticClass:"col-auto text-right txt1"},[s("span",{attrs:{id:"yongjin"}},[t._v(t._s(t.formatMoney(t.orders.commission)))])])])],1):t._e()]):t._e()],1)},u=[];function m(t,e,s,a,i,n,o){try{var r=t[n](o),c=r.value}catch(l){return void s(l)}r.done?e(c):Promise.resolve(c).then(a,i)}function d(t){return function(){var e=this,s=arguments;return new Promise((function(a,i){var n=t.apply(e,s);function o(t){m(n,a,i,o,r,"next",t)}function r(t){m(n,a,i,o,r,"throw",t)}o(void 0)}))}}function p(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function f(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?p(Object(s),!0).forEach((function(e){h(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function h(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var v={name:"OrdersDetail",props:{show:{type:Boolean,default:function(){return!1}},orders:{type:Object,default:function(){}}},computed:f({},Vuex.mapGetters(["currency","paramMapAll"])),watch:{show:function(t){this.showNew=t}},data:function(){return{showNew:!1,showPopPic:!1}},created:function(){this.showNew=this.show,this.orders&&(this.showPopPic=!!this.orders.popPic),this.getToken()},methods:{close:function(){this.$emit("close")},getToken:function(){var t=d(o.a.mark((function t(){return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("common/getToken");case 2:this.token=t.sent.data;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),commit:function(){var t=this;"1"===this.paramMapAll["GRAB_COMMIT_PWD_OPEN"]?this.$prompt(this.$t("message.please input withdraw password"),this.$t("message.提示"),{confirmButtonText:this.$t("message.确定"),cancelButtonText:this.$t("message.取消"),inputPattern:/^[1-9]\d*$/,inputErrorMessage:this.$t("message.withdraw password format error")}).then((function(e){var s=e.value;t.confirm(s)})).catch((function(){})):this.confirm()},confirm:function(t){var e=this,s=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(r["b"])(this.orders.id,{"X-IDEMPOTENT-TOKEN":this.token,password:t}).then((function(t){e.close(),e.$emit("confirm")})).finally((function(t){e.getToken(),s.close()}))}}},g=v,_=(s("3d55"),s("2877")),b=Object(_["a"])(g,l,u,!1,null,"443a4bf4",null),C=b.exports;function y(t,e,s,a,i,n,o){try{var r=t[n](o),c=r.value}catch(l){return void s(l)}r.done?e(c):Promise.resolve(c).then(a,i)}function w(t){return function(){var e=this,s=arguments;return new Promise((function(a,i){var n=t.apply(e,s);function o(t){y(n,a,i,o,r,"next",t)}function r(t){y(n,a,i,o,r,"throw",t)}o(void 0)}))}}function O(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function M(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?O(Object(s),!0).forEach((function(e){I(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):O(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function I(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var x={name:"MUserGrab",components:{OrdersDetail:C},computed:M(M({},Vuex.mapGetters(["currency","userInfo","userLevel","userMoney","paramMapAll"])),{},{getFinishTimes:function(){if(this.userInfo.grabRateOpen&&this.userInfo.fixedGrabTimes>0)return this.userInfo.fixedGrabTimes;if(this.planGroupInfo&&this.planGroupInfo.grabTimes>0)return this.planGroupInfo.grabTimes;if("1"===this.paramMapAll["CREDIT_OPEN"]){var t=parseInt(this.paramMapAll["CREDIT_GRAB_TIMES_HALF_MIN"]);if(t>0&&this.userMoney.credit<t)return this.levelInfo.grabTimes/2}return this.levelInfo.grabTimes},getLeftTimes:function(){var t=this.getFinishTimes-(this.userMoney.todayGrabTimes||0);return t<0?0:t},getCommission:function(){if("1"!==this.paramMapAll["GRAB_LEVEL_COMMISSION_OPEN"]){if(this.userInfo.grabRateOpen&&this.userInfo.fixedCommissionRate>0)return this.userInfo.fixedCommissionRate+"%";if(this.planGroupInfo&&this.planCntMap&&this.planCntMap[this.userMoney.todayGrabTimes+1]){var t=this.planCntMap[this.userMoney.todayGrabTimes+1];if(null!=t){if("rate"===t.commissionType&&null!=t.commissionRate)return t.commissionRate+"%";if("fixed_amount"===t.commissionType)return this.formatMoney(t.commissionAmount)}}}return this.levelInfo.grabCommissionRate+"%"}}),watch:{"$store.state.user.userLevel":function(t){null!==this.levelInfo&&this.levelInfo.id||(this.levelInfo=this.userLevel,this.levelId=this.levelInfo.id)}},data:function(){return{loading:!1,commission_list:[],levelId:null,levelInfo:null,token:null,orders:null,showDetail:!1,showPopPic:!1,planGroupInfo:null,planCntMap:{}}},created:function(){this.levelId=this.$route.query.levelId,this.getToken(),this.getLevelInfo(),this.getPlanGroupInfo(),this.getCommissionList()},methods:{getCommissionList:function(){var t=this;Object(r["c"])().then((function(e){t.commission_list=e.data}))},getLevelInfo:function(){var t=this;this.levelId?Object(c["g"])(this.levelId).then((function(e){t.levelInfo=e.data})):(this.levelInfo=this.userLevel,this.levelId=this.levelInfo.id)},getPlanGroupInfo:function(){var t=this;Object(c["o"])().then((function(e){t.planGroupInfo=e.data||{},t.planCntMap=t.listToMap(e.planList,"todayCnt")}))},getToken:function(){var t=w(o.a.mark((function t(){return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("common/getToken");case 2:this.token=t.sent.data;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),grab:function(){var t=this;this.loading=!0;var e=this.$loading({lock:!0,text:this.$t("message.正在选择商家"),spinner:"el-icon-loading",background:"L_27"===this.paramMapAll["SYSTEM_VERSION"]?"rgba(84, 89, 121, 0.9)":"rgba(0, 0, 0, 0.9)",customClass:"el-loading-grab el-loading-grab1"});setTimeout((function(){e.customClass="el-loading-grab el-loading-grab2",e.text=t.$t("message.正在匹配商品"),setTimeout((function(){Object(r["a"])({levelId:t.levelId,"X-IDEMPOTENT-TOKEN":t.token}).then((function(s){t.orders=s.data,"INIT"===t.orders.state?(t.$message.success(t.$t("message.抢单申请提交成功")),e.close()):"UNPAID"===t.orders.state&&(e.customClass="el-loading-grab el-loading-success",e.text=t.$t("message.匹配成功"),setTimeout((function(){e.close(),"1"===t.paramMapAll["GRAB_AUTO_SUBMIT_OPEN"]?t.autoCommit():t.showDetail=!0}),1e3*parseInt(t.paramMapAll["GRAB_SUCCESS_TIME"]||"2")))})).catch((function(t){e.close()})).finally((function(e){t.loading=!1,t.getToken(),t.$store.dispatch("user/getUserMoney")}))}),1e3*parseInt(t.paramMapAll["GRAB_RESPONSE_TIME"]||"3"))}),1e3*parseInt(this.paramMapAll["GRAB_REMOTE_TIME"]||"2"))},autoCommit:function(){var t=this;Object(r["b"])(this.orders.id,{"X-IDEMPOTENT-TOKEN":this.token}).then((function(e){t.$toast.success(t.$t("message.Commit Success")),t.getToken()})).finally((function(e){t.getToken()}))},closeOrders:function(){this.orders=null,this.showDetail=!1},confirm:function(){this.$toast.success(this.$t("message.Commit Success"))}}},P=x,T=(s("6bb1"),Object(_["a"])(P,a,i,!1,null,"16970c17",null));e["default"]=T.exports},c18d:function(t,e,s){"use strict";s.d(e,"c",(function(){return i})),s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return o})),s.d(e,"e",(function(){return r})),s.d(e,"d",(function(){return c}));var a=s("b775");function i(t){return Object(a["a"])({url:"/commission/list",method:"get"})}function n(t){return Object(a["a"])({url:"/user/grab/apply",method:"post",data:t})}function o(t,e){return Object(a["a"])({url:"/user/grab/orders/".concat(t,"/commit"),method:"post",data:e||{}})}function r(t){return Object(a["a"])({url:"/user/grab/orders/list",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/user/grab/orders/".concat(t,"/itemList"),method:"post"})}},c582:function(t,e,s){}}]);