(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e3e9c442"],{"073d":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content-wrap"},[s("van-nav-bar",{staticClass:"header",attrs:{fixed:"","z-index":"999"},scopedSlots:t._u([{key:"right",fn:function(){return[s("zlink",{attrs:{to:"/m/user/message"}},[s("i",{staticClass:"material-icons"},[t._v("notifications_none")])])]},proxy:!0}])}),s("van-tabs",{attrs:{type:"card",background:"#fff",color:"#6d00be","title-active-color":"#fff","title-inactive-color":"#6d00be",sticky:""},on:{click:function(e){return t.reload()}},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},[s("van-tab",{key:"all",attrs:{title:t.$t("message.全部"),name:"all"}}),t._l(["INIT","UNPAID","FINISH"],(function(e){return[s("van-tab",{key:e,attrs:{title:t.$t("message.订单状态."+e),name:e}})]}))],2),t.list&&0!==t.list.length?s("div",{staticClass:"container"},[t._l(t.list,(function(e,a){return s("div",{key:a,staticClass:"card mt-2",on:{click:function(s){return t.showItemList(e)}}},[s("div",{staticClass:"card-header bg-none"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("p",{staticClass:"text-secondary ft-12"},[t._v(t._s(e.createTime))])]),s("div",{staticClass:"col-auto"},[s("p",{staticClass:"badge badge-warning ft-12"},[t._v(t._s(e.no))])])])]),e.goodsId?[s("van-card",{attrs:{desc:"",currency:"",num:e.number,title:e.goodsName,thumb:t.getFileViewUrl(e.goodsPic)},scopedSlots:t._u([{key:"price",fn:function(){return[t._v(t._s(t.formatMoney(e.price)))]},proxy:!0},{key:"tags",fn:function(){return[s("van-tag",{attrs:{plain:"",type:"danger"}},[t._v(t._s(t.$t("message.订单状态."+e.state)))])]},proxy:!0}],null,!0)}),s("div",{staticClass:"card-footer"},[s("div",{staticClass:"row"},[s("div",{staticClass:"row-item d-flex justify-between full-width"},[s("div",{staticClass:"text-333"},[t._v(t._s(t.$t("message.订单总额")))]),s("div",{staticClass:"text-right text-mute"},[t._v(t._s(t.formatMoney(e.totalPrice)))])]),s("div",{staticClass:"row-item d-flex justify-between full-width"},[s("div",{staticClass:"text-333"},[t._v(t._s(t.$t("message.佣金")))]),s("div",{staticClass:"text-right text-mute"},[t._v(t._s(t.formatMoney(e.commission)))])]),e.frozenAmount?s("div",{staticClass:"row-item d-flex justify-between full-width"},[s("div",{staticClass:"text-333"},[t._v(t._s(t.$t("message.冻结金额")))]),s("div",{staticClass:"text-right text-mute"},[t._v(t._s(t.formatMoney(e.frozenAmount)))])]):t._e(),e.totalTaskNumber&&"1"!==t.paramMapAll["GRAB_TASK_NUMBER_CLOSE"]?s("div",{staticClass:"row-item d-flex justify-between full-width"},[s("div",{staticClass:"text-333"},[t._v(t._s(t.$t("message.当前进度")))]),s("div",{staticClass:"text-right text-mute progress"},[t._v(t._s(e.finishTaskNumber)+"/"+t._s(e.totalTaskNumber))])]):t._e(),e.frozenTime?s("div",{staticClass:"row-item d-flex justify-between full-width"},[s("div",{staticClass:"text-333"},[t._v(t._s(t.$t("message.任务时限"))+": "+t._s(e.frozenTime))]),s("div",{staticClass:"text-right text-mute"},[e.millisecond>0?s("van-count-down",{staticClass:"text-red",attrs:{time:e.millisecond,format:"HH:mm:ss"},on:{finish:function(s){return t.frozenOrders(e)}}}):t._e()],1)]):t._e(),e.unfreezeTime?s("div",{staticClass:"row-item d-flex justify-between full-width"},[s("div",{staticClass:"text-333"},[t._v(t._s(t.$t("message.解冻时间"))+": "+t._s(e.unfreezeTime))]),s("div",{staticClass:"text-right text-mute"},[e.unfreezeMillisecond>0?s("van-count-down",{staticClass:"text-red",attrs:{time:e.unfreezeMillisecond,format:"HH:mm:ss"},on:{finish:function(s){return t.unfreezeOrders(e)}}}):t._e()],1)]):t._e()]),"UNPAID"===e.state?s("div",{staticClass:"mt-4"},[s("van-button",{staticClass:"btn btn-block btn-lg btn-rounded shadow",attrs:{type:"primary"}},[t._v(t._s(t.$t("message.提交订单")))])],1):"FROZEN"===e.state?s("div",{staticClass:"mt-4"},[s("van-button",{staticClass:"btn btn-block btn-lg btn-rounded shadow",attrs:{type:"danger",to:"/m/support"}},[t._v(t._s(t.$t("message.解冻提示")))])],1):t._e()])]:t._e()],2)})),s("van-pagination",{attrs:{mode:"simple","total-items":t.total,"items-per-page":t.pageSize,"show-page-size":5,"force-ellipses":""},on:{change:t.getList},model:{value:t.curPage,callback:function(e){t.curPage=e},expression:"curPage"}})],2):s("van-empty",{attrs:{description:t.$t("message.No More Data")}}),s("van-dialog",{attrs:{title:t.$t("message.订单详情"),"cancel-button-text":"F_25"===t.paramMapAll["SYSTEM_VERSION"]?t.$t("message.恭喜你"):t.$t("message.关闭"),"confirm-button-text":"F_25"===t.paramMapAll["SYSTEM_VERSION"]?t.$t("message.抢单成功"):t.$t("message.submit"),"show-confirm-button":t.orders&&"UNPAID"===t.orders.state,"show-cancel-button":"","close-on-click-overlay":"",width:"90%"},on:{confirm:t.commit,close:function(e){return t.closeOrders()}},model:{value:t.showOrdersItem,callback:function(e){t.showOrdersItem=e},expression:"showOrdersItem"}},[!t.orders||t.itemList&&0!==t.itemList.length?[t.orders?s("div",{staticClass:"card pa-2"},["1"!==t.paramMapAll["GRAB_TASK_NUMBER_CLOSE"]?[s("div",[t._v(t._s(t.$t("message.当前订单任务数"))+"："),s("span",{staticClass:"text-red"},[t._v(t._s(t.orders.totalTaskNumber))])]),s("div",[t._v(t._s(t.$t("message.已完成"))+"："),s("span",{staticClass:"text-green"},[t._v(t._s(t.orders.finishTaskNumber))])])]:t._e()],2):t._e(),t._l(t.itemList,(function(e,a){return["INIT"!==e.state?s("div",{key:a,staticClass:"card pa-1"},[s("div",{staticClass:"orders-item"},[s("div",{staticClass:"row justify-center"},[s("img",{staticClass:"oimg",attrs:{alt:"",src:t.getFileViewUrl(e.goodsPic)}})]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.商品单价")))]),s("div",{staticClass:"col-auto text-right text-mute",attrs:{id:"goods_price"}},[t._v(t._s(t.formatMoney(e.price)))])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.商品数量")))]),s("div",{staticClass:"col-auto text-right text-mute"},[t._v("x "),s("span",{staticClass:"goods_num"},[t._v(t._s(e.number))])])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.订单总额")))]),s("div",{staticClass:"col-auto text-right text-mute"},[t._v(t._s(t.formatMoney(e.totalPrice)))])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.付款状态.title")))]),s("div",{staticClass:"col-auto text-right txt1"},[s("van-tag",{attrs:{type:t.state_type[e.state]}},[t._v(t._s(t.$t("message.付款状态."+e.state)))])],1)])])]):t._e()]}))]:s("div",{staticClass:"card pa-2"},[s("div",{staticClass:"row justify-center"},[s("img",{staticClass:"oimg",attrs:{alt:"",src:t.getFileViewUrl(t.orders.goodsPic)}})]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.订单号")))]),s("div",{staticClass:"col-auto text-right text-mute"},[t._v(t._s(t.orders.no))])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.下单时间")))]),s("div",{staticClass:"col-auto text-right text-mute"},[t._v(t._s(t.orders.createTime))])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.商品单价")))]),s("div",{staticClass:"col-auto text-right text-mute"},[t._v(t._s(t.formatMoney(t.orders.price)))])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.商品数量")))]),s("div",{staticClass:"col-auto text-right text-mute"},[t._v("x "),s("span",{attrs:{id:"goods_num"}},[t._v(t._s(t.orders.number))])])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.订单总额")))]),s("div",{staticClass:"col-auto text-right text-mute"},[t._v(t._s(t.formatMoney(t.orders.totalPrice)))])]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col text-left"},[t._v(t._s(t.$t("message.佣金")))]),s("div",{staticClass:"col-auto text-right txt1"},[s("span",[t._v(t._s(t.formatMoney(t.orders.commission)))])])])])],2)],1)},i=[],r=s("a34a"),n=s.n(r),o=s("c18d");function c(t,e,s,a,i,r,n){try{var o=t[r](n),c=o.value}catch(l){return void s(l)}o.done?e(c):Promise.resolve(c).then(a,i)}function l(t){return function(){var e=this,s=arguments;return new Promise((function(a,i){var r=t.apply(e,s);function n(t){c(r,a,i,n,o,"next",t)}function o(t){c(r,a,i,n,o,"throw",t)}n(void 0)}))}}function u(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function d(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?u(Object(s),!0).forEach((function(e){m(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function m(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var f={name:"MUserOrderList",components:{},computed:d({},Vuex.mapGetters(["currency","dictEnumMapAll"])),data:function(){return{list:[],token:null,state:"all",curPage:1,pageSize:20,total:0,showDetail:!1,orders:null,showOrdersItem:!1,itemList:null,state_type:{INIT:"primary",UNPAID:"danger",PART_PAID:"warning",PAID:"success"}}},created:function(){this.getList(),this.getToken()},methods:{getList:function(){var t=this;Object(o["e"])({state:"all"===this.state?null:this.state,curPage:this.curPage,pageSize:this.pageSize}).then((function(e){t.getToken();var s=e.data;t.total=parseInt(s.totalCount);var a=s.list;1===t.curPage?t.list=a:t.list=t.list.concat(a)}))},getToken:function(){var t=l(n.a.mark((function t(){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("common/getToken");case 2:this.token=t.sent.data;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),reload:function(){this.curPage=1,this.getList()},frozenOrders:function(t){t.state="FROZEN",t.millisecond=0},unfreezeOrders:function(t){t.state="FINISH",t.unfreezeMillisecond=0},showOrders:function(t){this.orders=t,this.showDetail=!0},closeOrders:function(){this.showDetail=!1,this.showOrdersItem=!1,this.getList()},showItemList:function(t){var e=this;this.showOrdersItem=!0,this.orders=t,Object(o["d"])(t.id).then((function(t){e.itemList=t.data||[]}))},commit:function(){var t=this;"1"===this.paramMapAll["GRAB_COMMIT_PWD_OPEN"]?this.$prompt(this.$t("message.please input withdraw password"),this.$t("message.提示"),{confirmButtonText:this.$t("message.确定"),cancelButtonText:this.$t("message.取消"),inputPattern:/^[1-9]\d*$/,inputErrorMessage:this.$t("message.withdraw password format error")}).then((function(e){var s=e.value;t.confirm(s)})).catch((function(){})):this.confirm()},confirm:function(t){var e=this,s=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(o["b"])(this.orders.id,{"X-IDEMPOTENT-TOKEN":this.token,password:t}).then((function(t){e.getToken(),e.$toast.success(e.$t("message.Commit Success"))})).finally((function(t){e.getToken(),e.closeOrders(),s.close()}))}}},v=f,g=(s("4e73"),s("2877")),_=Object(g["a"])(v,a,i,!1,null,"0c8d07c9",null);e["default"]=_.exports},"4e73":function(t,e,s){"use strict";s("f19f")},c18d:function(t,e,s){"use strict";s.d(e,"c",(function(){return i})),s.d(e,"a",(function(){return r})),s.d(e,"b",(function(){return n})),s.d(e,"e",(function(){return o})),s.d(e,"d",(function(){return c}));var a=s("b775");function i(t){return Object(a["a"])({url:"/commission/list",method:"get"})}function r(t){return Object(a["a"])({url:"/user/grab/apply",method:"post",data:t})}function n(t,e){return Object(a["a"])({url:"/user/grab/orders/".concat(t,"/commit"),method:"post",data:e||{}})}function o(t){return Object(a["a"])({url:"/user/grab/orders/list",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/user/grab/orders/".concat(t,"/itemList"),method:"post"})}},f19f:function(t,e,s){}}]);